"use strict";Object.defineProperty(exports, "__esModule", {value: true});// src/server/generateHTML.ts
var _core = require('@tiptap/core');
var _model = require('@tiptap/pm/model');

// src/server/getHTMLFromFragment.ts

var _happydom = require('happy-dom');
function getHTMLFromFragment(doc, schema, options) {
  if (options == null ? void 0 : options.document) {
    const wrap = options.document.createElement("div");
    _model.DOMSerializer.fromSchema(schema).serializeFragment(doc.content, { document: options.document }, wrap);
    return wrap.innerHTML;
  }
  const localWindow = new (0, _happydom.Window)();
  const fragment = _model.DOMSerializer.fromSchema(schema).serializeFragment(doc.content, {
    document: localWindow.document
  });
  const serializer = new localWindow.XMLSerializer();
  return serializer.serializeToString(fragment);
}

// src/server/generateHTML.ts
function generateHTML(doc, extensions) {
  if (typeof window !== "undefined") {
    throw new Error(
      "generateHTML can only be used in a Node environment\nIf you want to use this in a browser environment, use the `@tiptap/html` import instead."
    );
  }
  const schema = _core.getSchema.call(void 0, extensions);
  const contentNode = _model.Node.fromJSON(schema, doc);
  return getHTMLFromFragment(contentNode, schema);
}

// src/server/generateJSON.ts



function generateJSON(html, extensions, options) {
  if (typeof window !== "undefined") {
    throw new Error(
      "generateJSON can only be used in a Node environment\nIf you want to use this in a browser environment, use the `@tiptap/html` import instead."
    );
  }
  const localWindow = new (0, _happydom.Window)();
  const localDOMParser = new localWindow.DOMParser();
  const schema = _core.getSchema.call(void 0, extensions);
  let doc = null;
  const htmlString = `<!DOCTYPE html><html><body>${html}</body></html>`;
  doc = localDOMParser.parseFromString(htmlString, "text/html");
  if (!doc) {
    throw new Error("Failed to parse HTML string");
  }
  return _model.DOMParser.fromSchema(schema).parse(doc.body, options).toJSON();
}



exports.generateHTML = generateHTML; exports.generateJSON = generateJSON;
//# sourceMappingURL=index.cjs.map